kind: instance
apiVersion: config.istio.io/v1alpha2
metadata:
  name: handler-auto-rule2
  namespace: istio-system
  labels:
    kiali_wizard: threescale
  managedFields:
    - manager: Go-http-client
      operation: Update
      apiVersion: config.istio.io/v1alpha2
spec:
  params:
    action:
      method: request.method | "get"
      path: request.url_path
      service: 'destination.labels["service-mesh.3scale.net/service-id"] | ""'
    subject:
      properties:
        app_id: 'request.query_params["app_id"] | request.headers["app-id"] | ""'
        app_key: 'request.query_params["app_key"] | request.headers["app-key"] | ""'
        client_id: 'request.auth.claims["azp"] | ""'
      user: 'request.query_params["user_key"] | request.headers["x-user-key"] | ""'
  template: threescale-authorization
